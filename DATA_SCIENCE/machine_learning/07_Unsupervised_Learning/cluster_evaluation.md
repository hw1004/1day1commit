# 군집화 - 군집 평가 Cluster Evaluation
> 군집화 같은 비지도 학습 특성상 정확하게 성능을 평가하기에는 어렵다. 대표적으로 알려져 있는 성능평가는 **실루엣 분석** (각 군집 간의 거리가 얼마나 효율적으로 분리돼 있는지 분석)이다. 

## 실루엣 분석
### 실루엣 분석을 위한 사이킷런 메서드
1. `from sklearn.metrics import silhouette_samples`: 각 데이터 포인트의 실루엣 계수
2. `from sklearn.metrics import silhouette_score`: 전체 데이터의 실루엣 계수 평균 값 (0~1 사이의 값을 가지며 1에 가까울 수록 좋다.)
    - 전체 실루엣 계수의 평균값은 높아도, 특정 군집의 실루엣 계수 평균값만 유난히 높고 다른 군집들의 실루엣 계수 평균값은 낮으면 좋은 군집화 조건 아님

## 실루엣 분석 예제
1. KMeans를 이용해 군집화 진행
2. `silhouette_samples(군집에 사용한 feature, feature별 군집 결과)`: 군집화를 진행한 모든 개별 데이터에 실루엣 계수값을 구한다.
   - 구한 개별 데이터의 실루엣 계수값을 이용해 군집별 (ex. 0 1 2) 실루엣 계수 값의 평균을 보고 비교할 수 있다.
   - 특정 군집과 나머지 군집의 실루엣 계수 값의 평균이 차이가 많이 날 때는 좋은 군집이 아니다.
3. `silhouette_score(군집에 사용한 feature, feature별 군집 결과)`: 모든 데이터의 평균 실루엣 계수를 구한다.
4. 실루엣 그래프를 이용해서 실루엣 계수를 비교해가며 데이터에 적절한 최적의 군집의 개수를 파악할 수 있다.

## 엘보우 차트
> kmeans에만 적용 가능하며 **최적의 군집 수**를 확인할 수 있다. 
>
> SSE(Sum of Squared Errors) 값을 계산하여 그래프로 나타내어 최적의 k값을 선택하는 방법이다.
> - SSE: 각 데이터 포인트와 해당 클러스터 중심점 사이의 거리를 제곱한 값의 합 (값이 작을수록 클러스터링 성능이 좋다.)

```
sse= []
for k in range(1,11):  # 군집수를 1~10까지로 확인
    kmeans=KMeans(n_clusters=k, random_state=0)
    kmeans.fit(X)
    sse.append(kmeans.inertia_)  # sse값 저장되어 있는 속성
```
- 위에서 구한 k값에 따른 sse값들을 이용해 plot을 그린다.
- 만약 2에서 그래프가 꺾이는 양상이 보이면, 2가 최적의 군집 수이고, 변화가 거의 없으면 최적의 군집 수라고 볼 수 없다.


## 최적의 군집의 개수 구하는 방법
1. 실루엣 분석으로 군집의 개수 후보 선정
2. 엘보우차트를 이용해서 최종적으로 최적의 군집의 개수 선정